{% extends 'base.html' %}
{% load static %}

{% block content %}
<section id="page-title" class="page-title bg-overlay bg-parallax bg-overlay-gradient">
    <div class="bg-section">
        <img src="{% static 'img/blog_detail_main.jpg' %}" alt="Background" />
    </div>
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12">
                <div class="title title-4 text-center">
                    <div class="title--content">
                        <div class="title--subtitle">Don't miss</div>
                        <div class="title--heading">
                            <h1>{{ post.title }}</h1>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <ol class="breadcrumb">
                        <li><a href="{% url 'home' %}">Home</a>
                        </li>
                        <li><a href="{% url 'blog:list' %}">blog</a>
                        </li>
                        <li class="active">{{ post.title }}</li>
                    </ol>
                    <div class="divider--shape-1down divider--shape-gray"></div>
                </div>
                <!-- .title end -->
            </div>
            <!-- .col-md-12 end -->
        </div>
        <!-- .row end -->
    </div>
    <!-- .container end -->
</section>

<section id="blog" class="blog blog-single bg-gray pb-90">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-9">
                <!-- Blog Entry -->
                <div class="blog-entry">
                    <div class="entry--img">
							<img class="blog-detail" src="{{ post.image.url }}" alt="entry image" style="width: 100%!important; height: 450px!important;"/>
                    </div>
                    <div class="entry--content">
                        <div class="entry--meta">
                            <span>{{ post.created_at|date:"d.m.Y" }} / </span>
                            <span>
                                    {% for tag in post.tags.all %}
                                        <a href="{% url 'blog:posts_by_tag' tag.slug %}" class="tag-link">
                                            {{ tag.name }}
                                        </a>{% if not forloop.last %}, {% endif %}
                                    {% empty %}
                                        <span>No tags</span>
                                    {% endfor %}
                                </span>
                        </div>
                        <div class="entry--title">
                            <h3>{{ post.title }}</h3>
                        </div>
                        <div class="entry--bio">
                            {{ post.content|linebreaks }}
                        </div>
                    </div>
                </div>
                <!-- .blog-entry end -->

                <div class="entry-prev-next clearfix">
    <!-- Предыдущий пост -->
    <div class="entry-prev">
        <div class="entry-prev-content">
            {% with post.get_previous_by_created_at as prev_post %}
                {% if prev_post and prev_post.is_published %}
                    {% if prev_post.image %}
                        <img class="img-detail" src="{{ prev_post.image.url }}#blog" alt="{{ prev_post.title }}" style="width: 15%"/>
                    {% else %}
                        <img src="/static/img/blog_default.jpg" alt="{{ prev_post.title }}" />
                    {% endif %}
                    <div class="entry-desc">
                        <p>previous</p>
                        <a href="{{ prev_post.get_absolute_url }}#blog">
                            {{ prev_post.title|truncatechars:50 }}
                        </a>
                    </div>
                {% else %}
                    <!-- Если предыдущего поста нет, показываем заглушку -->
                    <div class="entry-desc no-post">
                        <p>previous</p>
                        <span>This is the first post</span>
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    </div>

    <!-- Следующий пост -->
    <div class="entry-next">
        <div class="entry-next-content">
            {% with post.get_next_by_created_at as next_post %}
                {% if next_post and next_post.is_published %}
                    {% if next_post.image %}
                        <img class="img-detail" src="{{ next_post.image.url }}#blog" alt="{{ next_post.title }}" style="width: 15%"/>
                    {% else %}
                        <img src="/static/img/blog_default.jpg" alt="{{ next_post.title }}" />
                    {% endif %}
                    <div class="entry-desc">
                        <p>next</p>
                        <a href="{{ next_post.get_absolute_url }}#blog">
                            {{ next_post.title|truncatechars:50 }}
                        </a>
                    </div>
                {% else %}
                    <!-- Если следующего поста нет, показываем заглушку -->
                    <div class="entry-desc no-post">
                        <p>next</p>
                        <span>This is the last post</span>
                    </div>
                {% endif %}
            {% endwith %}
        </div>
    </div>
</div>
                <!-- .entry-bio end -->

            </div>
            <!-- .col-md-9 end -->
            <div class="col-xs-12 col-sm-12 col-md-3">
                <!-- Search
============================================= -->
<div class="widget widget-search">
    <div class="widget--content">
        <form method="get" action="{% url 'blog:list' %}#blog" class="form-search">
            <div class="input-group">
                <input type="text" class="form-control" name="q" placeholder="Type Your Search Words">
                <span class="input-group-btn">
                    <button class="btn" type="submit"><i class="fa fa-search"></i></button>
				</span>
            </div>
        </form>
    </div>
</div>
<!-- .widget-search end -->


<!-- Recent Posts
============================================= -->
<div class="widget widget-recent-posts">
    <div class="widget--title">
        <h5>best posts</h5>
    </div>
    <div class="widget--content">
        {% for best_post in best_posts %}
            <div class="entry">
                {% if best_post.image %}
                    <img src="{{ best_post.image.url }}" alt="{{ best_post.title }}" />
                {% endif %}
                <div class="entry-desc">
                    <div class="entry-meta">
                        {{ best_post.created_at|date:"M d, Y" }}
                        {% if best_post.is_best %}
                            <span class="best-badge">★</span>
                        {% endif %}
                    </div>
                    <div class="entry-title">
                        <a href="{% url 'blog:detail' best_post.id %}#blog">
                            {{ best_post.title|truncatechars:40 }}
                        </a>
                    </div>
                </div>
            </div>
        {% endfor %}
        <!-- .recent-entry end -->
    </div>
</div>
<!-- .widget-recent end -->


<!-- Tag Clouds
============================================= -->
<div class="widget widget-tags">
    <div class="widget--title">
        <h5>tag clouds</h5>
    </div>
    <div class="widget--content">
        {% for tag in all_tags %}
        <a href="{% url 'blog:posts_by_tag' tag.slug %}">{{ tag.name }}</a>
        {% endfor %}
    </div>
</div>
<!-- .widget-tags end -->
            </div>
            <!-- .col-md-3 end -->
        </div>
        <!-- .row end -->
    </div>
    <!-- .container end -->
</section>
<!-- #blog end -->

<div class="clearfix"></div>
{% endblock %}